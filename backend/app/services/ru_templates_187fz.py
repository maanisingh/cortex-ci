"""
187-ФЗ «О безопасности критической информационной инфраструктуры»
Complete document package for KII (Critical Information Infrastructure) compliance

Document categories:
1. Organization documents (organizational structure for KII)
2. Object categorization (categorization of KII objects)
3. Security requirements (security measures per category)
4. Incident response (GosSOPKA interaction)
5. Audit and monitoring (regular assessments)
"""

from typing import Any

# Complete 187-FZ document templates
TEMPLATES_187FZ: list[dict[str, Any]] = [
    # ============ ORGANIZATIONAL DOCUMENTS ============
    {
        "template_code": "KII_POLICY",
        "title": "Политика обеспечения безопасности критической информационной инфраструктуры",
        "title_en": "Critical Information Infrastructure Security Policy",
        "document_type": "policy",
        "framework": "fz187",
        "requirement_ref": "187-ФЗ ст. 10",
        "form_fields": [
            {"name": "company_name", "label": "Наименование организации", "type": "text", "required": True},
            {"name": "inn", "label": "ИНН", "type": "text", "required": True},
            {"name": "director_name", "label": "ФИО руководителя", "type": "text", "required": True},
            {"name": "security_responsible", "label": "Ответственный за безопасность КИИ", "type": "text", "required": True},
        ],
        "template_content": """
УТВЕРЖДАЮ
Генеральный директор
{{company_name}}
_________________ / {{director_name}} /
«____» _____________ 202__ г.

ПОЛИТИКА
обеспечения безопасности критической информационной инфраструктуры
{{company_name}}

1. ОБЩИЕ ПОЛОЖЕНИЯ

1.1. Настоящая Политика разработана в соответствии с:
- Федеральным законом от 26.07.2017 № 187-ФЗ «О безопасности критической информационной инфраструктуры Российской Федерации»;
- Постановлением Правительства РФ от 08.02.2018 № 127 «Об утверждении Правил категорирования объектов критической информационной инфраструктуры»;
- Приказом ФСТЭК России от 21.12.2017 № 235 «Об утверждении Требований к созданию систем безопасности значимых объектов КИИ»;
- Приказом ФСТЭК России от 25.12.2017 № 239 «Об утверждении Требований по обеспечению безопасности значимых объектов КИИ».

1.2. Политика определяет:
- принципы обеспечения безопасности объектов КИИ;
- структуру системы безопасности;
- порядок категорирования объектов КИИ;
- требования к персоналу;
- порядок взаимодействия с ГосСОПКА.

2. ТЕРМИНЫ И ОПРЕДЕЛЕНИЯ

Критическая информационная инфраструктура — объекты КИИ, а также сети электросвязи, используемые для организации взаимодействия таких объектов.

Объект КИИ — информационная система, информационно-телекоммуникационная сеть, автоматизированная система управления субъекта КИИ.

Значимый объект КИИ — объект КИИ, которому присвоена одна из категорий значимости.

ГосСОПКА — государственная система обнаружения, предупреждения и ликвидации последствий компьютерных атак.

3. ПРИНЦИПЫ ОБЕСПЕЧЕНИЯ БЕЗОПАСНОСТИ КИИ

3.1. Законность — соответствие требованиям законодательства РФ.
3.2. Непрерывность — обеспечение постоянной защиты объектов КИИ.
3.3. Комплексность — применение организационных и технических мер.
3.4. Адекватность — соразмерность мер защиты актуальным угрозам.
3.5. Экономическая целесообразность — обоснованность затрат на безопасность.

4. ОРГАНИЗАЦИОННАЯ СТРУКТУРА

4.1. Ответственный за обеспечение безопасности КИИ: {{security_responsible}}

4.2. Функции ответственного:
- организация работ по категорированию объектов КИИ;
- разработка и актуализация документации;
- контроль выполнения требований безопасности;
- взаимодействие с ФСТЭК России и ФСБ России;
- организация реагирования на инциденты.

5. КАТЕГОРИРОВАНИЕ ОБЪЕКТОВ КИИ

5.1. Категорирование проводится в соответствии с ПП РФ № 127.

5.2. Категории значимости:
- Первая категория — наивысшая значимость
- Вторая категория — средняя значимость
- Третья категория — базовая значимость

5.3. Критерии значимости:
- социальная значимость;
- политическая значимость;
- экономическая значимость;
- экологическая значимость;
- значимость для обороны и безопасности.

6. ТРЕБОВАНИЯ К БЕЗОПАСНОСТИ

6.1. Для значимых объектов КИИ обеспечивается:
- управление доступом;
- идентификация и аутентификация;
- защита машинных носителей;
- аудит безопасности;
- антивирусная защита;
- обнаружение вторжений;
- защита периметра;
- обеспечение целостности;
- обеспечение доступности.

7. ВЗАИМОДЕЙСТВИЕ С ГОССОПКА

7.1. Организация обеспечивает:
- подключение к ГосСОПКА;
- информирование о компьютерных инцидентах;
- содействие в ликвидации последствий атак;
- выполнение указаний координационного центра.

8. КОНТРОЛЬ И МОНИТОРИНГ

8.1. Проводится регулярный мониторинг:
- состояния защищённости объектов КИИ;
- выполнения требований безопасности;
- работоспособности средств защиты.

8.2. Внутренний аудит безопасности — не реже 1 раза в год.

9. ОТВЕТСТВЕННОСТЬ

9.1. Нарушение требований 187-ФЗ влечёт:
- административную ответственность (ст. 13.12.1 КоАП РФ);
- уголовную ответственность (ст. 274.1 УК РФ).

10. ЗАКЛЮЧИТЕЛЬНЫЕ ПОЛОЖЕНИЯ

10.1. Политика вступает в силу с момента утверждения.
10.2. Пересмотр Политики — не реже 1 раза в год.
""",
    },
    {
        "template_code": "KII_RESPONSIBLE_ORDER",
        "title": "Приказ о назначении ответственного за безопасность КИИ",
        "title_en": "Order on Appointment of KII Security Responsible",
        "document_type": "order",
        "framework": "fz187",
        "requirement_ref": "Приказ ФСТЭК № 235 п. 10",
        "form_fields": [
            {"name": "company_name", "label": "Наименование организации", "type": "text", "required": True},
            {"name": "order_number", "label": "Номер приказа", "type": "text", "required": True},
            {"name": "order_date", "label": "Дата приказа", "type": "date", "required": True},
            {"name": "responsible_name", "label": "ФИО ответственного", "type": "text", "required": True},
            {"name": "responsible_position", "label": "Должность", "type": "text", "required": True},
            {"name": "director_name", "label": "ФИО руководителя", "type": "text", "required": True},
        ],
        "template_content": """
{{company_name}}

ПРИКАЗ

«{{order_date}}»                                                № {{order_number}}

О назначении ответственного за обеспечение безопасности
объектов критической информационной инфраструктуры

В соответствии с требованиями Федерального закона от 26.07.2017 № 187-ФЗ «О безопасности критической информационной инфраструктуры Российской Федерации» и Приказа ФСТЭК России от 21.12.2017 № 235

ПРИКАЗЫВАЮ:

1. Назначить ответственным за обеспечение безопасности объектов критической информационной инфраструктуры {{company_name}} {{responsible_position}} {{responsible_name}}.

2. На {{responsible_name}} возложить следующие обязанности:

2.1. Организация работ по категорированию объектов КИИ и представление сведений о результатах категорирования в ФСТЭК России.

2.2. Разработка и поддержание в актуальном состоянии организационно-распорядительных документов по обеспечению безопасности объектов КИИ.

2.3. Планирование и координация мероприятий по созданию системы безопасности значимых объектов КИИ.

2.4. Контроль выполнения требований по обеспечению безопасности значимых объектов КИИ.

2.5. Организация работы по реагированию на компьютерные инциденты и взаимодействия с ГосСОПКА.

2.6. Организация обучения работников, осуществляющих эксплуатацию значимых объектов КИИ.

2.7. Взаимодействие с ФСТЭК России и ФСБ России по вопросам обеспечения безопасности КИИ.

2.8. Подготовка отчётности о состоянии безопасности объектов КИИ.

3. {{responsible_name}} обеспечить:

3.1. Проведение инвентаризации информационных систем для определения объектов КИИ — в срок до _____________.

3.2. Формирование комиссии по категорированию объектов КИИ — в срок до _____________.

3.3. Проведение категорирования объектов КИИ — в срок до _____________.

4. Контроль за исполнением настоящего приказа оставляю за собой.


Генеральный директор                _______________         {{director_name}}

С приказом ознакомлен:

{{responsible_position}}             _______________         {{responsible_name}}
«____» _____________ 202__ г.
""",
    },
    {
        "template_code": "KII_COMMISSION_ORDER",
        "title": "Приказ о создании комиссии по категорированию объектов КИИ",
        "title_en": "Order on Establishing KII Categorization Commission",
        "document_type": "order",
        "framework": "fz187",
        "requirement_ref": "ПП РФ № 127 п. 11",
        "form_fields": [
            {"name": "company_name", "label": "Наименование организации", "type": "text", "required": True},
            {"name": "order_number", "label": "Номер приказа", "type": "text", "required": True},
            {"name": "order_date", "label": "Дата приказа", "type": "date", "required": True},
            {"name": "commission_chair", "label": "Председатель комиссии", "type": "text", "required": True},
            {"name": "chair_position", "label": "Должность председателя", "type": "text", "required": True},
            {"name": "member1_name", "label": "Член комиссии 1", "type": "text", "required": True},
            {"name": "member1_position", "label": "Должность члена 1", "type": "text", "required": True},
            {"name": "member2_name", "label": "Член комиссии 2", "type": "text", "required": True},
            {"name": "member2_position", "label": "Должность члена 2", "type": "text", "required": True},
            {"name": "director_name", "label": "ФИО руководителя", "type": "text", "required": True},
        ],
        "template_content": """
{{company_name}}

ПРИКАЗ

«{{order_date}}»                                                № {{order_number}}

О создании комиссии по категорированию
объектов критической информационной инфраструктуры

В соответствии с Постановлением Правительства РФ от 08.02.2018 № 127 «Об утверждении Правил категорирования объектов критической информационной инфраструктуры Российской Федерации»

ПРИКАЗЫВАЮ:

1. Создать постоянно действующую комиссию по категорированию объектов критической информационной инфраструктуры {{company_name}} в следующем составе:

Председатель комиссии:
{{chair_position}} — {{commission_chair}}

Члены комиссии:
{{member1_position}} — {{member1_name}}
{{member2_position}} — {{member2_name}}

2. Комиссии по категорированию:

2.1. Провести инвентаризацию информационных систем, информационно-телекоммуникационных сетей и автоматизированных систем управления организации.

2.2. Определить объекты КИИ из числа информационных систем, сетей и АСУ организации.

2.3. Провести оценку показателей критериев значимости для каждого объекта КИИ.

2.4. Определить категорию значимости каждого объекта КИИ или принять решение об отсутствии необходимости присвоения категории.

2.5. Оформить акт категорирования для каждого объекта КИИ.

2.6. Сформировать перечень объектов КИИ для направления в ФСТЭК России.

3. Установить срок проведения категорирования — до «____» _____________ 202__ г.

4. Контроль за исполнением настоящего приказа возложить на ответственного за обеспечение безопасности КИИ.


Генеральный директор                _______________         {{director_name}}

С приказом ознакомлены:

{{chair_position}}                  _______________         {{commission_chair}}
{{member1_position}}                _______________         {{member1_name}}
{{member2_position}}                _______________         {{member2_name}}
""",
    },

    # ============ CATEGORIZATION DOCUMENTS ============
    {
        "template_code": "KII_OBJECTS_LIST",
        "title": "Перечень объектов критической информационной инфраструктуры",
        "title_en": "List of Critical Information Infrastructure Objects",
        "document_type": "list",
        "framework": "fz187",
        "requirement_ref": "ПП РФ № 127 п. 15",
        "form_fields": [
            {"name": "company_name", "label": "Наименование организации", "type": "text", "required": True},
            {"name": "inn", "label": "ИНН", "type": "text", "required": True},
            {"name": "ogrn", "label": "ОГРН", "type": "text", "required": True},
            {"name": "sphere", "label": "Сфера деятельности", "type": "select", "required": True,
             "options": ["Здравоохранение", "Наука", "Транспорт", "Связь", "Энергетика", "Банки", "ТЭК", "Оборона", "Ракетно-космическая", "Горнодобывающая", "Металлургия", "Химическая"]},
        ],
        "template_content": """
УТВЕРЖДАЮ
Генеральный директор
{{company_name}}
_________________ / ___________________ /
«____» _____________ 202__ г.

ПЕРЕЧЕНЬ
объектов критической информационной инфраструктуры
{{company_name}}

Субъект КИИ: {{company_name}}
ИНН: {{inn}}
ОГРН: {{ogrn}}
Сфера деятельности: {{sphere}}

№ п/п | Наименование объекта КИИ | Тип объекта | Категория значимости | Дата категорирования
------|-------------------------|-------------|---------------------|--------------------
1     |                         | ИС / ИТС / АСУ |                  |
2     |                         | ИС / ИТС / АСУ |                  |
3     |                         | ИС / ИТС / АСУ |                  |

Сокращения:
ИС — информационная система
ИТС — информационно-телекоммуникационная сеть
АСУ — автоматизированная система управления

Ответственный за ведение перечня: _________________________
                                    (должность, ФИО)

Дата формирования перечня: «____» _____________ 202__ г.
""",
    },
    {
        "template_code": "KII_CATEGORIZATION_ACT",
        "title": "Акт категорирования объекта КИИ",
        "title_en": "KII Object Categorization Act",
        "document_type": "act",
        "framework": "fz187",
        "requirement_ref": "ПП РФ № 127 п. 16",
        "form_fields": [
            {"name": "company_name", "label": "Наименование организации", "type": "text", "required": True},
            {"name": "object_name", "label": "Наименование объекта КИИ", "type": "text", "required": True},
            {"name": "object_type", "label": "Тип объекта", "type": "select", "required": True,
             "options": ["Информационная система", "Информационно-телекоммуникационная сеть", "Автоматизированная система управления"]},
            {"name": "category", "label": "Категория значимости", "type": "select", "required": True,
             "options": ["Первая", "Вторая", "Третья", "Без категории"]},
            {"name": "commission_chair", "label": "Председатель комиссии", "type": "text", "required": True},
            {"name": "act_date", "label": "Дата акта", "type": "date", "required": True},
        ],
        "template_content": """
УТВЕРЖДАЮ
Генеральный директор
{{company_name}}
_________________ / ___________________ /
«____» _____________ 202__ г.

АКТ
категорирования объекта критической информационной инфраструктуры

Дата: {{act_date}}

1. СВЕДЕНИЯ ОБ ОБЪЕКТЕ КИИ

1.1. Наименование объекта КИИ: {{object_name}}
1.2. Тип объекта: {{object_type}}
1.3. Субъект КИИ: {{company_name}}

2. ОЦЕНКА ПОКАЗАТЕЛЕЙ КРИТЕРИЕВ ЗНАЧИМОСТИ

2.1. Социальная значимость:
- Причинение ущерба жизни и здоровью людей: _________
- Прекращение или нарушение функционирования объектов жизнеобеспечения: _________

2.2. Политическая значимость:
- Прекращение или нарушение функционирования органов государственной власти: _________

2.3. Экономическая значимость:
- Причинение ущерба субъекту КИИ: _________
- Прекращение или нарушение проведения клиентами операций: _________

2.4. Экологическая значимость:
- Вредное воздействие на окружающую среду: _________

2.5. Значимость для обороны страны и безопасности государства:
- Прекращение или нарушение функционирования объектов обороны: _________

3. РЕШЕНИЕ КОМИССИИ

3.1. На основании проведённой оценки показателей критериев значимости объекту КИИ «{{object_name}}» присвоена {{category}} категория значимости.

3.2. Обоснование решения:
__________________________________________________________________________
__________________________________________________________________________

4. ПОДПИСИ ЧЛЕНОВ КОМИССИИ

Председатель комиссии: _________________ / {{commission_chair}} /

Члены комиссии:
_________________ / _________________ /
_________________ / _________________ /
_________________ / _________________ /

Дата категорирования: «____» _____________ 202__ г.
""",
    },

    # ============ SECURITY SYSTEM DOCUMENTS ============
    {
        "template_code": "KII_SECURITY_SYSTEM",
        "title": "Положение о системе безопасности значимых объектов КИИ",
        "title_en": "Regulation on Security System for Significant KII Objects",
        "document_type": "regulation",
        "framework": "fz187",
        "requirement_ref": "Приказ ФСТЭК № 235",
        "form_fields": [
            {"name": "company_name", "label": "Наименование организации", "type": "text", "required": True},
            {"name": "director_name", "label": "ФИО руководителя", "type": "text", "required": True},
        ],
        "template_content": """
УТВЕРЖДАЮ
Генеральный директор
{{company_name}}
_________________ / {{director_name}} /
«____» _____________ 202__ г.

ПОЛОЖЕНИЕ
о системе безопасности значимых объектов
критической информационной инфраструктуры
{{company_name}}

1. ОБЩИЕ ПОЛОЖЕНИЯ

1.1. Настоящее Положение определяет структуру, функции и порядок функционирования системы безопасности значимых объектов критической информационной инфраструктуры (далее — система безопасности) {{company_name}}.

1.2. Система безопасности создаётся в соответствии с:
- Федеральным законом от 26.07.2017 № 187-ФЗ;
- Приказом ФСТЭК России от 21.12.2017 № 235;
- Приказом ФСТЭК России от 25.12.2017 № 239.

2. ЦЕЛИ И ЗАДАЧИ СИСТЕМЫ БЕЗОПАСНОСТИ

2.1. Цель системы безопасности — обеспечение устойчивого функционирования значимых объектов КИИ при проведении в отношении них компьютерных атак.

2.2. Задачи системы безопасности:
- предотвращение неправомерного доступа к информации;
- предотвращение нарушения функционирования объектов КИИ;
- обеспечение восстановления объектов КИИ после атак.

3. СТРУКТУРА СИСТЕМЫ БЕЗОПАСНОСТИ

3.1. Система безопасности включает:
- силы обеспечения безопасности;
- программные и программно-аппаратные средства;
- организационно-распорядительные документы.

3.2. Силы обеспечения безопасности:
- ответственный за обеспечение безопасности КИИ;
- подразделение по защите информации;
- работники, эксплуатирующие значимые объекты КИИ.

4. ФУНКЦИИ СИСТЕМЫ БЕЗОПАСНОСТИ

4.1. Система безопасности обеспечивает:

4.1.1. Управление доступом:
- идентификация и аутентификация пользователей;
- разграничение доступа к функциям и информации;
- управление привилегированными учётными записями.

4.1.2. Защиту от вредоносного ПО:
- антивирусная защита;
- контроль запуска программ;
- контроль использования съёмных носителей.

4.1.3. Обнаружение вторжений:
- мониторинг сетевого трафика;
- анализ событий безопасности;
- выявление аномалий.

4.1.4. Защиту информации:
- криптографическая защита;
- защита каналов связи;
- защита от утечек.

4.1.5. Обеспечение целостности:
- контроль целостности ПО;
- контроль конфигураций;
- резервное копирование.

4.1.6. Обеспечение доступности:
- резервирование критичных компонентов;
- планы восстановления;
- регулярное тестирование.

5. ТРЕБОВАНИЯ К ПЕРСОНАЛУ

5.1. Требования к ответственному за безопасность КИИ:
- высшее образование в области ИБ или переподготовка;
- опыт работы в области ИБ не менее 3 лет;
- повышение квалификации не реже 1 раза в 3 года.

5.2. Требования к работникам подразделения по ЗИ:
- образование в области ИБ или переподготовка;
- регулярное повышение квалификации.

6. ПОРЯДОК ФУНКЦИОНИРОВАНИЯ

6.1. Планирование:
- анализ угроз безопасности;
- разработка планов мероприятий;
- распределение ресурсов.

6.2. Реализация:
- внедрение мер защиты;
- обучение персонала;
- документирование.

6.3. Контроль:
- мониторинг состояния защищённости;
- проведение аудитов;
- анализ инцидентов.

6.4. Совершенствование:
- анализ эффективности;
- актуализация мер защиты;
- устранение недостатков.

7. ВЗАИМОДЕЙСТВИЕ С ГОССОПКА

7.1. Организация обеспечивает:
- информирование о компьютерных инцидентах;
- содействие в обнаружении и ликвидации атак;
- выполнение указаний НКЦКИ.

8. ЗАКЛЮЧИТЕЛЬНЫЕ ПОЛОЖЕНИЯ

8.1. Положение вступает в силу с момента утверждения.
8.2. Актуализация — не реже 1 раза в год.
""",
    },
    {
        "template_code": "KII_THREAT_MODEL",
        "title": "Модель угроз безопасности объекта КИИ",
        "title_en": "Threat Model for KII Object",
        "document_type": "model",
        "framework": "fz187",
        "requirement_ref": "Приказ ФСТЭК № 239 п. 11",
        "form_fields": [
            {"name": "company_name", "label": "Наименование организации", "type": "text", "required": True},
            {"name": "object_name", "label": "Наименование объекта КИИ", "type": "text", "required": True},
            {"name": "category", "label": "Категория значимости", "type": "select", "required": True,
             "options": ["Первая", "Вторая", "Третья"]},
        ],
        "template_content": """
УТВЕРЖДАЮ
Генеральный директор
{{company_name}}
_________________ / ___________________ /
«____» _____________ 202__ г.

МОДЕЛЬ УГРОЗ
безопасности информации значимого объекта
критической информационной инфраструктуры
«{{object_name}}»

1. ОБЩИЕ СВЕДЕНИЯ

1.1. Объект защиты: {{object_name}}
1.2. Категория значимости: {{category}}
1.3. Субъект КИИ: {{company_name}}

2. ОПИСАНИЕ ОБЪЕКТА КИИ

2.1. Назначение объекта: _________________________
2.2. Сфера применения: _________________________
2.3. Архитектура: _________________________

3. ВОЗМОЖНЫЕ НЕГАТИВНЫЕ ПОСЛЕДСТВИЯ

3.1. Нарушение или прекращение функционирования объекта КИИ
3.2. Утрата или модификация информации
3.3. Несанкционированный доступ к информации
3.4. Нарушение безопасности технологических процессов

4. НАРУШИТЕЛИ БЕЗОПАСНОСТИ

4.1. Внешние нарушители:
- Н1: Специальные службы иностранных государств
- Н2: Террористические и экстремистские группировки
- Н3: Криминальные структуры
- Н4: Конкуренты
- Н5: Хакеры и хактивисты

4.2. Внутренние нарушители:
- Н6: Бывшие работники
- Н7: Работники организации
- Н8: Работники подрядных организаций

5. АКТУАЛЬНЫЕ УГРОЗЫ БЕЗОПАСНОСТИ

№ | Угроза | Источник | Объект воздействия | Способ реализации | Последствия | Уровень опасности
--|--------|----------|-------------------|-------------------|-------------|------------------
1 | УБИ.001: Угроза внедрения вредоносного ПО | Н1-Н5 | ПО объекта КИИ | Через сеть, носители | Нарушение функционирования | Высокий
2 | УБИ.002: Угроза НСД | Н1-Н8 | Информация | Подбор паролей | Утечка данных | Высокий
3 | УБИ.003: Угроза DDoS-атаки | Н1-Н5 | Сетевая инфраструктура | Перегрузка сервисов | Отказ в обслуживании | Средний
4 | УБИ.004: Угроза социальной инженерии | Н1-Н5 | Персонал | Фишинг, обман | Компрометация УЗ | Средний
5 | УБИ.005: Угроза эксплуатации уязвимостей | Н1-Н5 | ПО, ОС | Эксплойты | НСД, нарушение работы | Высокий

6. СПОСОБЫ РЕАЛИЗАЦИИ УГРОЗ

6.1. Через сеть Интернет
6.2. Через съёмные носители
6.3. Через каналы связи
6.4. Через поставщиков и подрядчиков
6.5. Через инсайдеров

7. МЕРЫ ЗАЩИТЫ

Для нейтрализации выявленных угроз применяются меры в соответствии с Приказом ФСТЭК России № 239.

8. ЗАКЛЮЧЕНИЕ

Модель угроз подлежит актуализации:
- при изменении объекта КИИ;
- при появлении новых угроз;
- не реже 1 раза в год.

Разработал: _________________________
Согласовал: _________________________
""",
    },

    # ============ INCIDENT RESPONSE DOCUMENTS ============
    {
        "template_code": "KII_INCIDENT_PROCEDURE",
        "title": "Порядок реагирования на компьютерные инциденты",
        "title_en": "Computer Incident Response Procedure",
        "document_type": "procedure",
        "framework": "fz187",
        "requirement_ref": "187-ФЗ ст. 9, Приказ ФСБ № 367",
        "form_fields": [
            {"name": "company_name", "label": "Наименование организации", "type": "text", "required": True},
            {"name": "director_name", "label": "ФИО руководителя", "type": "text", "required": True},
            {"name": "security_responsible", "label": "Ответственный за безопасность КИИ", "type": "text", "required": True},
            {"name": "nkcki_contact", "label": "Контакт НКЦКИ", "type": "text", "required": False},
        ],
        "template_content": """
УТВЕРЖДАЮ
Генеральный директор
{{company_name}}
_________________ / {{director_name}} /
«____» _____________ 202__ г.

ПОРЯДОК
реагирования на компьютерные инциденты
в {{company_name}}

1. ОБЩИЕ ПОЛОЖЕНИЯ

1.1. Настоящий Порядок определяет действия работников {{company_name}} при обнаружении и реагировании на компьютерные инциденты, связанные с функционированием объектов КИИ.

1.2. Компьютерный инцидент — факт нарушения и (или) прекращения функционирования объекта КИИ, в том числе произошедший в результате компьютерной атаки.

2. КЛАССИФИКАЦИЯ ИНЦИДЕНТОВ

2.1. По критичности:
- Критический — угроза жизни и здоровью, полное прекращение функционирования
- Высокий — существенное нарушение функционирования
- Средний — частичное нарушение функционирования
- Низкий — незначительное нарушение

2.2. По типу:
- Вредоносное ПО
- Несанкционированный доступ
- DDoS-атака
- Утечка данных
- Сбой оборудования

3. ПОРЯДОК ОБНАРУЖЕНИЯ ИНЦИДЕНТОВ

3.1. Источники обнаружения:
- Средства мониторинга и обнаружения вторжений
- Антивирусные системы
- Системы анализа событий (SIEM)
- Обращения пользователей
- Информация от ГосСОПКА

3.2. Признаки инцидента:
- Аномальная сетевая активность
- Необъяснимое снижение производительности
- Несанкционированные изменения
- Срабатывание средств защиты

4. ПОРЯДОК РЕАГИРОВАНИЯ

4.1. При обнаружении признаков инцидента работник ОБЯЗАН:
- Немедленно сообщить ответственному за безопасность КИИ: {{security_responsible}}
- Зафиксировать время обнаружения и признаки
- Не предпринимать самостоятельных действий по устранению

4.2. Ответственный за безопасность КИИ:
- Проводит первичную оценку инцидента
- Определяет критичность
- Принимает решение об информировании руководства
- Координирует работы по реагированию

4.3. Этапы реагирования:
1) Обнаружение и идентификация
2) Локализация и сдерживание
3) Устранение последствий
4) Восстановление
5) Анализ и документирование

5. ВЗАИМОДЕЙСТВИЕ С ГОССОПКА

5.1. Об инцидентах на значимых объектах КИИ организация обязана информировать НКЦКИ.

5.2. Сроки информирования:
- О компьютерном инциденте — не позднее 24 часов
- О результатах реагирования — в течение 48 часов

5.3. Контакт НКЦКИ: {{nkcki_contact}}
   Сайт: https://cert.gov.ru

6. ДОКУМЕНТИРОВАНИЕ

6.1. По каждому инциденту оформляется:
- Карточка инцидента
- Акт о результатах реагирования
- Отчёт в ГосСОПКА (при необходимости)

7. ОТВЕТСТВЕННОСТЬ

7.1. Работники несут ответственность за несвоевременное информирование об инцидентах.

7.2. Ответственный за безопасность КИИ несёт ответственность за организацию реагирования.

КОНТАКТНАЯ ИНФОРМАЦИЯ

Ответственный за безопасность КИИ: {{security_responsible}}
Телефон: _______________
Email: _______________
""",
    },
    {
        "template_code": "KII_INCIDENT_CARD",
        "title": "Карточка компьютерного инцидента",
        "title_en": "Computer Incident Card",
        "document_type": "form",
        "framework": "fz187",
        "requirement_ref": "Приказ ФСБ № 367",
        "form_fields": [
            {"name": "company_name", "label": "Наименование организации", "type": "text", "required": True},
            {"name": "object_name", "label": "Объект КИИ", "type": "text", "required": True},
            {"name": "incident_date", "label": "Дата обнаружения", "type": "date", "required": True},
            {"name": "incident_type", "label": "Тип инцидента", "type": "select", "required": True,
             "options": ["Вредоносное ПО", "НСД", "DDoS", "Утечка данных", "Сбой", "Другое"]},
        ],
        "template_content": """
{{company_name}}

КАРТОЧКА КОМПЬЮТЕРНОГО ИНЦИДЕНТА

Регистрационный номер: ________________
Дата регистрации: {{incident_date}}

1. СВЕДЕНИЯ ОБ ИНЦИДЕНТЕ

1.1. Объект КИИ: {{object_name}}
1.2. Дата и время обнаружения: {{incident_date}} ____:____
1.3. Кем обнаружен: _______________________
1.4. Тип инцидента: {{incident_type}}
1.5. Критичность: [ ] Критический [ ] Высокий [ ] Средний [ ] Низкий

2. ОПИСАНИЕ ИНЦИДЕНТА

2.1. Признаки инцидента:
___________________________________________________________________________
___________________________________________________________________________

2.2. Затронутые компоненты:
___________________________________________________________________________

2.3. Влияние на функционирование объекта КИИ:
___________________________________________________________________________

3. ПРЕДПРИНЯТЫЕ ДЕЙСТВИЯ

3.1. Локализация:
___________________________________________________________________________

3.2. Устранение:
___________________________________________________________________________

3.3. Восстановление:
___________________________________________________________________________

4. РЕЗУЛЬТАТЫ РЕАГИРОВАНИЯ

4.1. Инцидент устранён: [ ] Да [ ] Нет
4.2. Дата и время устранения: «____» ____________ 202__ г. ____:____
4.3. Причина инцидента: _______________________
4.4. Рекомендации по предотвращению: _______________________

5. ИНФОРМИРОВАНИЕ ГОССОПКА

5.1. Информация направлена: [ ] Да [ ] Нет (не требуется)
5.2. Дата и время направления: _______________________
5.3. Номер уведомления в ГосСОПКА: _______________________

6. ПОДПИСИ

Обнаружил:           _________________ / _________________ /
Регистрацию провёл:  _________________ / _________________ /
Устранение провёл:   _________________ / _________________ /
Ответственный за КИИ: _________________ / _________________ /
""",
    },

    # ============ AUDIT DOCUMENTS ============
    {
        "template_code": "KII_AUDIT_PROGRAM",
        "title": "Программа аудита безопасности объектов КИИ",
        "title_en": "KII Security Audit Program",
        "document_type": "program",
        "framework": "fz187",
        "requirement_ref": "Приказ ФСТЭК № 235 п. 36",
        "form_fields": [
            {"name": "company_name", "label": "Наименование организации", "type": "text", "required": True},
            {"name": "audit_year", "label": "Год проведения", "type": "text", "required": True},
            {"name": "director_name", "label": "ФИО руководителя", "type": "text", "required": True},
        ],
        "template_content": """
УТВЕРЖДАЮ
Генеральный директор
{{company_name}}
_________________ / {{director_name}} /
«____» _____________ 202__ г.

ПРОГРАММА
аудита безопасности объектов критической информационной инфраструктуры
на {{audit_year}} год

1. ЦЕЛИ АУДИТА

1.1. Оценка соответствия требованиям 187-ФЗ, Приказов ФСТЭК № 235, № 239.
1.2. Оценка эффективности системы безопасности.
1.3. Выявление уязвимостей и недостатков.
1.4. Разработка рекомендаций по совершенствованию.

2. ОБЪЕКТЫ АУДИТА

№ | Объект КИИ | Категория | Период проверки
--|-----------|-----------|----------------
1 |           |           | Q1 / Q2 / Q3 / Q4
2 |           |           | Q1 / Q2 / Q3 / Q4
3 |           |           | Q1 / Q2 / Q3 / Q4

3. НАПРАВЛЕНИЯ АУДИТА

3.1. Организационные меры:
- наличие и актуальность документации;
- назначение ответственных лиц;
- обучение персонала.

3.2. Технические меры:
- конфигурации средств защиты;
- управление уязвимостями;
- мониторинг и реагирование.

3.3. Физическая безопасность:
- контроль доступа в помещения;
- защита оборудования.

4. МЕТОДЫ АУДИТА

- Анализ документации
- Интервьюирование персонала
- Техническое тестирование
- Анализ конфигураций
- Тестирование на проникновение (по согласованию)

5. РЕСУРСЫ

5.1. Команда аудита:
- Руководитель аудита
- Технический эксперт
- Эксперт по документации

5.2. Инструменты:
- Сканеры уязвимостей
- Анализаторы конфигураций
- Чек-листы проверки

6. ОТЧЁТНОСТЬ

6.1. По результатам аудита формируется:
- Отчёт об аудите
- План устранения выявленных недостатков
- Рекомендации по совершенствованию

6.2. Сроки представления отчёта — 10 рабочих дней после завершения аудита.

7. ГРАФИК ПРОВЕДЕНИЯ

Квартал | Объекты | Направления | Ответственный
--------|---------|-------------|---------------
Q1      |         |             |
Q2      |         |             |
Q3      |         |             |
Q4      |         |             |

Ответственный за выполнение программы: _________________________
""",
    },
    {
        "template_code": "KII_AUDIT_REPORT",
        "title": "Отчёт об аудите безопасности объекта КИИ",
        "title_en": "KII Object Security Audit Report",
        "document_type": "report",
        "framework": "fz187",
        "requirement_ref": "Приказ ФСТЭК № 235 п. 36",
        "form_fields": [
            {"name": "company_name", "label": "Наименование организации", "type": "text", "required": True},
            {"name": "object_name", "label": "Объект КИИ", "type": "text", "required": True},
            {"name": "audit_date_start", "label": "Дата начала", "type": "date", "required": True},
            {"name": "audit_date_end", "label": "Дата окончания", "type": "date", "required": True},
            {"name": "auditor_name", "label": "Руководитель аудита", "type": "text", "required": True},
        ],
        "template_content": """
{{company_name}}

ОТЧЁТ
об аудите безопасности объекта критической информационной инфраструктуры
«{{object_name}}»

Период проведения: {{audit_date_start}} — {{audit_date_end}}
Руководитель аудита: {{auditor_name}}

1. ВВЕДЕНИЕ

1.1. Цель аудита: оценка соответствия требованиям по обеспечению безопасности объекта КИИ.

1.2. Основание: Программа аудита безопасности объектов КИИ на 202__ год.

1.3. Нормативные документы:
- Федеральный закон № 187-ФЗ
- Приказ ФСТЭК России № 235
- Приказ ФСТЭК России № 239

2. ОБЪЕКТ АУДИТА

2.1. Наименование: {{object_name}}
2.2. Категория значимости: _______________
2.3. Субъект КИИ: {{company_name}}

3. РЕЗУЛЬТАТЫ АУДИТА

3.1. Организационные меры

№ | Требование | Статус | Комментарий
--|-----------|--------|------------
1 | Назначен ответственный за безопасность КИИ | [ ] Соответствует / [ ] Не соответствует |
2 | Документация разработана и актуальна | [ ] Соответствует / [ ] Не соответствует |
3 | Персонал обучен | [ ] Соответствует / [ ] Не соответствует |

3.2. Технические меры

№ | Мера защиты | Статус | Комментарий
--|------------|--------|------------
1 | Управление доступом | [ ] Реализовано / [ ] Частично / [ ] Не реализовано |
2 | Антивирусная защита | [ ] Реализовано / [ ] Частично / [ ] Не реализовано |
3 | Обнаружение вторжений | [ ] Реализовано / [ ] Частично / [ ] Не реализовано |
4 | Резервное копирование | [ ] Реализовано / [ ] Частично / [ ] Не реализовано |
5 | Мониторинг событий | [ ] Реализовано / [ ] Частично / [ ] Не реализовано |

3.3. Выявленные несоответствия

№ | Несоответствие | Требование | Критичность | Рекомендация
--|---------------|-----------|-------------|-------------
1 |               |           | Высокая/Средняя/Низкая |
2 |               |           | Высокая/Средняя/Низкая |

4. ВЫВОДЫ

4.1. Общий уровень соответствия: _____%

4.2. Сильные стороны:
- _______________
- _______________

4.3. Области для улучшения:
- _______________
- _______________

5. РЕКОМЕНДАЦИИ

5.1. Срочные (устранить в течение 30 дней):
- _______________

5.2. Плановые (устранить в течение 90 дней):
- _______________

6. ПОДПИСИ

Руководитель аудита:      _________________ / {{auditor_name}} /
Ответственный за КИИ:     _________________ / _________________ /
Руководитель объекта КИИ: _________________ / _________________ /

Дата: «____» _____________ 202__ г.
""",
    },

    # ============ TRAINING DOCUMENTS ============
    {
        "template_code": "KII_TRAINING_PROGRAM",
        "title": "Программа обучения персонала по безопасности КИИ",
        "title_en": "KII Security Personnel Training Program",
        "document_type": "program",
        "framework": "fz187",
        "requirement_ref": "Приказ ФСТЭК № 235 п. 15",
        "form_fields": [
            {"name": "company_name", "label": "Наименование организации", "type": "text", "required": True},
            {"name": "director_name", "label": "ФИО руководителя", "type": "text", "required": True},
        ],
        "template_content": """
УТВЕРЖДАЮ
Генеральный директор
{{company_name}}
_________________ / {{director_name}} /
«____» _____________ 202__ г.

ПРОГРАММА
обучения персонала по вопросам обеспечения безопасности
объектов критической информационной инфраструктуры

1. ОБЩИЕ ПОЛОЖЕНИЯ

1.1. Программа определяет порядок обучения работников по вопросам безопасности КИИ.

1.2. Цели обучения:
- формирование знаний о требованиях 187-ФЗ;
- развитие навыков безопасной работы;
- подготовка к реагированию на инциденты.

2. КАТЕГОРИИ ОБУЧАЕМЫХ

2.1. Категория 1: Руководство
- Знание законодательства о КИИ
- Ответственность за безопасность
- Периодичность: 1 раз в год

2.2. Категория 2: Ответственные за безопасность КИИ
- Углублённые знания требований
- Практические навыки управления безопасностью
- Периодичность: при назначении + повышение квалификации 1 раз в 3 года

2.3. Категория 3: Администраторы и операторы объектов КИИ
- Безопасная эксплуатация
- Выявление и реагирование на инциденты
- Периодичность: при приёме + 1 раз в год

2.4. Категория 4: Пользователи
- Базовые правила безопасности
- Периодичность: при приёме + 1 раз в год

3. СОДЕРЖАНИЕ ОБУЧЕНИЯ

3.1. Модуль 1: Нормативная база (2 часа)
- Федеральный закон № 187-ФЗ
- Требования ФСТЭК и ФСБ
- Ответственность за нарушения

3.2. Модуль 2: Угрозы безопасности (2 часа)
- Типы угроз и атак
- Социальная инженерия
- Вредоносное ПО

3.3. Модуль 3: Меры защиты (3 часа)
- Организационные меры
- Технические меры
- Правила безопасной работы

3.4. Модуль 4: Реагирование на инциденты (2 часа)
- Признаки инцидентов
- Порядок действий
- Взаимодействие с ГосСОПКА

3.5. Модуль 5: Практические занятия (3 часа)
- Разбор инцидентов
- Тестирование знаний

4. ФОРМЫ ОБУЧЕНИЯ

- Очное обучение (семинары, тренинги)
- Дистанционное обучение (онлайн-курсы)
- Самообучение (изучение документации)
- Практические занятия (учения)

5. КОНТРОЛЬ ЗНАНИЙ

5.1. Тестирование по итогам обучения
5.2. Минимальный порог — 80% правильных ответов
5.3. При неудовлетворительном результате — повторное обучение

6. ДОКУМЕНТИРОВАНИЕ

6.1. Журнал учёта обучения
6.2. Протоколы тестирования
6.3. Сертификаты (свидетельства) об обучении

7. ПЛАН ОБУЧЕНИЯ НА ГОД

Категория | Q1 | Q2 | Q3 | Q4
----------|----|----|----|----|
Руководство | X |   |   |
Ответственные за КИИ | X |   |   |
Администраторы |   | X |   |
Пользователи |   |   | X |

Ответственный за организацию обучения: _________________________
""",
    },
    {
        "template_code": "KII_NONDISCLOSURE",
        "title": "Обязательство о неразглашении сведений об объектах КИИ",
        "title_en": "KII Non-Disclosure Agreement",
        "document_type": "obligation",
        "framework": "fz187",
        "requirement_ref": "Приказ ФСТЭК № 235 п. 18",
        "form_fields": [
            {"name": "company_name", "label": "Наименование организации", "type": "text", "required": True},
            {"name": "employee_name", "label": "ФИО работника", "type": "text", "required": True},
            {"name": "employee_position", "label": "Должность", "type": "text", "required": True},
        ],
        "template_content": """
ОБЯЗАТЕЛЬСТВО
о неразглашении сведений об объектах критической информационной инфраструктуры

Я, {{employee_name}}, занимающий(ая) должность {{employee_position}} в {{company_name}},

ОБЯЗУЮСЬ:

1. Не разглашать сведения об объектах критической информационной инфраструктуры {{company_name}}, ставшие мне известными в связи с исполнением должностных обязанностей, в том числе:

- сведения о составе и архитектуре объектов КИИ;
- сведения о применяемых мерах защиты;
- сведения об уязвимостях и недостатках;
- сведения о компьютерных инцидентах;
- сведения о категориях значимости объектов КИИ.

2. Использовать полученную информацию исключительно для выполнения должностных обязанностей.

3. Не копировать и не выносить за пределы организации документы и носители информации об объектах КИИ без разрешения.

4. Немедленно сообщать ответственному за безопасность КИИ о ставших мне известными фактах разглашения указанных сведений.

5. В случае увольнения вернуть все носители информации и не разглашать сведения.

Я ПРЕДУПРЕЖДЁН(А):

- О возможности привлечения к дисциплинарной ответственности за нарушение настоящего обязательства.

- Об ответственности по статье 274.1 УК РФ за неправомерное воздействие на КИИ.

- Об ответственности по статье 183 УК РФ за незаконное получение и разглашение коммерческой тайны.

Настоящее обязательство действует бессрочно, в том числе после прекращения трудовых отношений с {{company_name}}.

Дата: «____» _____________ 202__ г.

Подпись: ___________________ / {{employee_name}} /

Обязательство принял:

Ответственный за безопасность КИИ: ___________________ / ___________________ /
""",
    },
]


def get_187fz_templates() -> list[dict[str, Any]]:
    """Return all 187-FZ document templates."""
    return TEMPLATES_187FZ


def get_template_by_code(code: str) -> dict[str, Any] | None:
    """Get a specific template by its code."""
    for template in TEMPLATES_187FZ:
        if template["template_code"] == code:
            return template
    return None


def get_templates_by_type(doc_type: str) -> list[dict[str, Any]]:
    """Get all templates of a specific type."""
    return [t for t in TEMPLATES_187FZ if t["document_type"] == doc_type]
